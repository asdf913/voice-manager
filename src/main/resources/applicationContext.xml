<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd">

	<bean id="iniSection"
		class="java.util.concurrent.atomic.AtomicReference"></bean>

	<bean
		class="org.springframework.context.support.PropertySourcesPlaceholderConfigurer">
		<property name="ignoreResourceNotFound" value="true" />
		<property name="locations">
			<list>
				<value>classpath:configuration.properties</value>
				<value>file:configuration.properties</value>
				<bean
					class="org.springframework.core.io.IniAsPropertiesResource">
					<constructor-arg index="0"
						value="file:configuration.ini" />
					<property name="section" ref="iniSection" />
				</bean>
			</list>
		</property>
	</bean>

	<bean
		class="org.springframework.context.CustomBeanFactoryPostProcessor">
		<property name="tableSql" value="classpath:table.sql" />
		<property name="tableSqlEncoding"
			value="${org.springframework.context.CustomBeanFactoryPostProcessor.tableSqlEncoding}" />
		<property name="iniSection" ref="iniSection" />
	</bean>

	<!-- -->
	<bean id="ipaJsonUrl" class="java.lang.String">
		<constructor-arg index="0"
			value="${org.springframework.beans.factory.IpaMultimapFactoryBean.url}" />
	</bean>

	<!-- -->
	<bean class="org.springframework.context.support.VoiceManager">
		<property name="layout">
			<bean
				class="org.springframework.beans.factory.MigLayoutFactoryBean">
				<property name="arguments"
					value="${org.springframework.beans.factory.MigLayoutFactoryBean.arguments}" />
			</bean>
		</property>
		<property name="defaultCloseOperation"
			value="#{T(javax.swing.WindowConstants).EXIT_ON_CLOSE}" />
		<property name="title"
			value="${org.springframework.context.support.VoiceManager.title}" />
		<property name="sqlSessionFactory" ref="SqlSessionFactory" />
		<property name="voiceFolder"
			value="${org.springframework.context.support.VoiceManager.voiceFolder}" />
		<property name="outputFolder"
			value="${org.springframework.context.support.VoiceManager.outputFolder}" />
		<property name="outputFolderFileNameExpressions"
			value="${org.springframework.context.support.VoiceManager.outputFolderFileNameExpressions}" />
		<property name="speechApi">
			<bean class="org.springframework.context.support.SpeechApiImpl" />
		</property>
		<property name="mp3Tags"
			value="${org.springframework.context.support.VoiceManager.mp3Tags}" />
		<property name="microsoftSpeechObjectLibraryAttributeNames"
			value="${org.springframework.context.support.VoiceManager.microsoftSpeechObjectLibraryAttributeNames}" />
		<property name="jlptLevelPageUrl"
			value="${org.springframework.context.support.VoiceManager.jlptLevelPageUrl}" />
		<property name="gaKuNenBeTsuKanJiListPageUrl"
			value="${org.springframework.context.support.VoiceManager.gaKuNenBeTsuKanJiListPageUrl}" />
		<property
			name="microsoftSpeechPlatformRuntimeDownloadPageUrl"
			value="${org.springframework.context.support.VoiceManager.microsoftSpeechPlatformRuntimeDownloadPageUrl}" />
		<property
			name="microsoftSpeechPlatformRuntimeLanguagesDownloadPageUrl"
			value="${org.springframework.context.support.VoiceManager.microsoftSpeechPlatformRuntimeLanguagesDownloadPageUrl}" />
		<property name="microsoftWindowsCompatibilitySettingsPageUrl"
			value="${org.springframework.context.support.VoiceManager.microsoftWindowsCompatibilitySettingsPageUrl}" />
		<property name="mediaFormatPageUrl"
			value="${org.springframework.context.support.VoiceManager.mediaFormatPageUrl}" />
		<property name="poiEncryptionPageUrl"
			value="${org.springframework.context.support.VoiceManager.poiEncryptionPageUrl}" />
		<property name="exportHtmlTemplateFile"
			value="${org.springframework.context.support.VoiceManager.exportHtmlTemplateFile}" />
		<property name="exportWebSpeechSynthesisHtmlTemplateFile"
			value="${org.springframework.context.support.VoiceManager.exportWebSpeechSynthesisHtmlTemplateFile}" />
		<property
			name="exportWebSpeechSynthesisHtmlTemplateProperties"
			value="${org.springframework.context.support.VoiceManager.exportWebSpeechSynthesisHtmlTemplateProperties}" />
		<property name="freeMarkerVersion"
			value="${org.springframework.context.support.VoiceManager.freeMarkerVersion}" />
		<property name="freeMarkerConfiguration">
			<bean class="freemarker.template.Configuration">
				<constructor-arg index="0"
					value="#{T(freemarker.template.Configuration).getVersion()}" />
				<property name="templateLoader"
					value="#{new freemarker.cache.ClassTemplateLoader(T(org.springframework.context.support.VoiceManager),'/')}" />
			</bean>
		</property>
		<property name="exportPresentationTemplate"
			value="${org.springframework.context.support.VoiceManager.exportPresentationTemplate}" />
		<property name="folderInPresentation"
			value="${org.springframework.context.support.VoiceManager.folderInPresentation}" />
		<property name="microsoftAccessFileFormat"
			value="${org.springframework.context.support.VoiceManager.microsoftAccessFileFormat}" />
		<property name="workbookClass"
			value="${org.springframework.context.support.VoiceManager.workbookClass}" />
		<property name="jSoupParseTimeout"
			value="${org.springframework.context.support.VoiceManager.jSoupParseTimeout}" />
		<property name="ipaJsonUrl" ref="ipaJsonUrl" />
		<property name="ipaJsonResource" value="classpath:ipa.json" />
		<property name="messageDigestAlgorithm"
			value="${org.springframework.context.support.VoiceManager.messageDigestAlgorithm}" />
		<property name="ipaSymbolMultimap">
			<bean
				class="org.springframework.beans.factory.IpaMultimapFactoryBean">
				<property name="url" ref="ipaJsonUrl" />
				<property name="resource" value="classpath:ipa.json" />
			</bean>
		</property>
	</bean>

	<bean id="DataSource" class="org.h2.jdbcx.JdbcConnectionPool"
		factory-method="create">
		<constructor-arg index="0"
			value="jdbc:h2:file:./voice_manager" />
		<constructor-arg index="1"
			value="${org.h2.jdbcx.JdbcDataSource.user}" />
		<constructor-arg index="2"
			value="${org.h2.jdbcx.JdbcDataSource.password}" />
	</bean>

	<bean id="SqlSessionFactory"
		class="org.mybatis.spring.SqlSessionFactoryBean">
		<property name="dataSource" ref="DataSource" />
		<property name="mapperLocations"
			value="classpath*:mapper/**/*.xml" />
	</bean>

	<!-- FLAC -->
	<bean
		class="org.springframework.context.support.VoiceManager$AudioToFlacByteConverter">
		<meta key="format" value="flac" />
		<property name="audioStreamEncoderByteArrayLength"
			value="${net.sourceforge.javaflacencoder.FLACEncoder.byteArrayLength}" />
	</bean>

	<!-- MP3 -->
	<bean
		class="org.springframework.context.support.VoiceManager.AudioToMp3ByteConverter">
		<meta key="format" value="mp3" />
		<property name="bitRate"
			value="${de.sciss.jump3r.lowlevel.LameEncoder.bitRate}" />
		<property name="quality"
			value="${de.sciss.jump3r.lowlevel.LameEncoder.quality}" />
		<property name="vbr"
			value="${de.sciss.jump3r.lowlevel.LameEncoder.vbr}" />
	</bean>

</beans>